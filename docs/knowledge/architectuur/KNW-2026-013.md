# KNW-2026-013: Parameters voor composability in plaats van post-hoc string manipulatie

## Metadata
- **Categorie:** architectuur
- **Relevantie:** midden
- **Datum:** 2026-02-28
- **Sessie-context:** D4 Export feature — review finding PYT-004

## Inzicht

Wanneer output op verschillende niveaus genest kan worden (bijv. Markdown headings in een sub-document), gebruik een parameter op de genererende functie (bijv. `heading_level`) in plaats van de output achteraf te manipuleren met string replace. Parameters zijn expliciet, composable, en breken niet bij onverwachte content.

## Context

`export_project_markdown()` riep `export_session_markdown()` aan en deed daarna `content.replace("# ", "## ")` om heading-levels te verschuiven. Dit brak bij content die `# ` bevatte in code blocks of beschrijvingen. De fix: een `heading_level` parameter toevoegen aan `export_session_markdown()` waarmee de caller het gewenste niveau meegeeft.

## Geleerd

- **str.replace op structured output is fragiel:** Het mist context-awareness — het weet niet of `# ` een heading is of tekst in een code block.
- **Compositie via parameters is robuuster:** `export_session_markdown(session, heading_level=2)` is duidelijk in intent en voorkomt edge cases.
- **Dit patroon geldt breder:** HTML nesting, JSON templates met variabele diepte, geneste config-bestanden.

## Toepassing

- Elke functie die structured text genereert die in verschillende contexten hergebruikt wordt.
- Template engines waar output op verschillende niveaus wordt ingebed.
- Document generators die secties op variabele diepte moeten renderen.
